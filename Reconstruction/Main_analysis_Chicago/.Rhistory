require(dplyr)
others = 1
Female_adult_weight = seq(0.5,2.5,0.05)
mean_dynamic = matrix(NA,length(Female_adult_weight),17)
sd_dynamic = matrix(NA,length(Female_adult_weight),17)
for(i in 1:length(Female_adult_weight)){
weight = Female_adult_weight[i]
Harvest_weight_vector = c(others,others,rep(weight,6),rep(others,3))
Harvest_matrix_at_this_level = matrix(Harvest_weight_vector,nrow = 11,ncol = 17)
Scheme_temp = ReCAP::analysisScheme(Chicago_RES$mcmc.objs,
Assumptions,c(8,3),
16,Harvest_matrix_at_this_level,quota = F)
mean_dynamic_temp = Reduce("+",Scheme_temp)/length(Scheme_temp)
mean_dynamic_temp_sum = colSums(mean_dynamic_temp)
mean_dynamic[i,] = mean_dynamic_temp_sum
}
load("/media/yunyi/Academia/UW Lab jobs/3. Lislie Reconstruction/DDLeslie_package/Chicago_scheme/Population_simulation_scheme/4harv_8fec_6surv_equal.RData")
others = 1
Female_adult_weight = seq(0.5,2.5,0.05)
mean_dynamic = matrix(NA,length(Female_adult_weight),17)
sd_dynamic = matrix(NA,length(Female_adult_weight),17)
for(i in 1:length(Female_adult_weight)){
weight = Female_adult_weight[i]
Harvest_weight_vector = c(others,others,rep(weight,6),rep(others,3))
Harvest_matrix_at_this_level = matrix(Harvest_weight_vector,nrow = 11,ncol = 17)
Scheme_temp = ReCAP::analysisScheme(Chicago_RES$mcmc.objs,
Assumptions,c(8,3),
16,Harvest_matrix_at_this_level,quota = F)
mean_dynamic_temp = Reduce("+",Scheme_temp)/length(Scheme_temp)
mean_dynamic_temp_sum = colSums(mean_dynamic_temp)
mean_dynamic[i,] = mean_dynamic_temp_sum
}
Female_adult_weight = seq(0.5,2.5,0.5)
Female_adult_weight = seq(0.5,2,0.5)
mean_dynamic = matrix(NA,length(Female_adult_weight),17)
sd_dynamic = matrix(NA,length(Female_adult_weight),17)
pp <- list()
i = 1
weight = Female_adult_weight[i]
Harvest_weight_vector = c(others,others,rep(weight,6),rep(others,3))
Harvest_matrix_at_this_level = matrix(Harvest_weight_vector,nrow = 11,ncol = 17)
Scheme_temp = ReCAP::analysisScheme(Chicago_RES$mcmc.objs,
Assumptions,c(8,3),
16,Harvest_matrix_at_this_level,quota = F)
mean_dynamic_temp = Reduce("+",Scheme_temp)/length(Scheme_temp)
mean_dynamic_temp_sum = colSums(mean_dynamic_temp)
mean_dynamic_temp
mean_dynamic_temp_sum
View(mean_dynamic_temp)
Reduce(sd, Scheme_temp)
sum_temp = lapply(Scheme_temp,function(w){
colSums( w,na.rm = T)
})
View(sum_temp)
sum_temp = sapply(Scheme_temp,function(w){
colSums( w,na.rm = T)
})
View(sum_temp)
sum_temp <- t(sum_temp)
plot_temp <- data.frame(year = 1992:2008,
population = mean_dynamic_temp_sum,
lw = apply(sum_temp,2,quantile, 0.05),
hi = apply(sum_temp,2,quantile, 0.95))
weight = Female_adult_weight[i]
Harvest_weight_vector = c(others,others,rep(weight,6),rep(others,3))
Harvest_matrix_at_this_level = matrix(Harvest_weight_vector,nrow = 11,ncol = 17)
Scheme_temp = ReCAP::analysisScheme(Chicago_RES$mcmc.objs,
Assumptions,c(8,3),
16,Harvest_matrix_at_this_level,quota = F)
sum_temp = sapply(Scheme_temp,function(w){
colSums( w,na.rm = T)
})
sum_temp <- t(sum_temp)
mean_dynamic_temp = Reduce("+",Scheme_temp)/length(Scheme_temp)
mean_dynamic_temp_sum = colSums(mean_dynamic_temp)
mean_dynamic[i,] = mean_dynamic_temp_sum
plot_temp <- data.frame(year = 1992:2008,
population = mean_dynamic_temp_sum,
lw = apply(sum_temp,2,quantile, 0.05),
hi = apply(sum_temp,2,quantile, 0.95))
pp[[i]] <- ggplot(data = plot_temp,aes(x = year,y=population))+
geom_line() +
geom_point() +
geom_errorbar(aes(ymin=lw, ymax=hi), width=.1) +
ylab("Reconstructed Population") +
theme(text = element_text(size=18), axis.text.x = element_text(size = 16))+
geom_hline(yintercept=goal, linetype="dashed")
pp[[i]] <- ggplot2::ggplot(data = plot_temp,aes(x = year,y=population))+
geom_line() +
geom_point() +
geom_errorbar(aes(ymin=lw, ymax=hi), width=.1) +
ylab("Reconstructed Population") +
theme(text = element_text(size=18), axis.text.x = element_text(size = 16))+
geom_hline(yintercept=goal, linetype="dashed")
library(ggplot2)
pp[[i]] <- ggplot(data = plot_temp,aes(x = year,y=population))+
geom_line() +
geom_point() +
geom_errorbar(aes(ymin=lw, ymax=hi), width=.1) +
ylab("Reconstructed Population") +
theme(text = element_text(size=18), axis.text.x = element_text(size = 16))+
geom_hline(yintercept=goal, linetype="dashed")
pp[[i]] <- ggplot(data = plot_temp,aes(x = year,y=population))+
geom_line() +
geom_point() +
geom_errorbar(aes(ymin=lw, ymax=hi), width=.1) +
ylab("Reconstructed Population") +
theme(text = element_text(size=18), axis.text.x = element_text(size = 16))+
geom_hline(yintercept=500, linetype="dashed")
pp[[1]]
for(i in 1:length(Female_adult_weight)){
weight = Female_adult_weight[i]
Harvest_weight_vector = c(others,others,rep(weight,6),rep(others,3))
Harvest_matrix_at_this_level = matrix(Harvest_weight_vector,nrow = 11,ncol = 17)
Scheme_temp = ReCAP::analysisScheme(Chicago_RES$mcmc.objs,
Assumptions,c(8,3),
16,Harvest_matrix_at_this_level,quota = F)
sum_temp = sapply(Scheme_temp,function(w){
colSums( w,na.rm = T)
})
sum_temp <- t(sum_temp)
mean_dynamic_temp = Reduce("+",Scheme_temp)/length(Scheme_temp)
mean_dynamic_temp_sum = colSums(mean_dynamic_temp)
mean_dynamic[i,] = mean_dynamic_temp_sum
plot_temp <- data.frame(year = 1992:2008,
population = mean_dynamic_temp_sum,
lw = apply(sum_temp,2,quantile, 0.05),
hi = apply(sum_temp,2,quantile, 0.95))
pp[[i]] <- ggplot(data = plot_temp,aes(x = year,y=population))+
geom_line() +
geom_point() +
geom_errorbar(aes(ymin=lw, ymax=hi), width=.1) +
ylab("Reconstructed Population") +
#theme(text = element_text(size=18), axis.text.x = element_text(size = 16))+
geom_hline(yintercept=500, linetype="dashed")
}
libarary(ggpubr)
library(ggpubr)
ggarrange(plotlist = pp)
??ggarrange
ggarrange(plotlist = pp, labels = c(0,5,1,1.5,2))
ggarrange(plotlist = pp, labels = c("0.5","1","1.5","2"))
ggarrange(plotlist = pp, labels = c("0.5","1","1.5","2"), label.x = 1)
ggarrange(plotlist = pp, labels = c("0.5","1","1.5","2"), label.x = 1994)
ggarrange(plotlist = pp, labels = c("0.5","1","1.5","2"), label.x = 0.3)
ggarrange(plotlist = pp, labels = c("weight 0.5","weight 1","weight 1.5","weight 2"), label.x = 0.3)
ggarrange(plotlist = pp, labels = c("weight 0.5","weight 1","weight 1.5","weight 2"), label.x = 0.2)
ggarrange(plotlist = pp, labels = c("weight 0.5","weight 1","weight 1.5","weight 2"), label.x = 0.2)
ggsave("./noDD4case.pdf", weight = 8, height = 6, scale = 0.9)
ggsave("./noDD4case.pdf", width = 8, height = 6, scale = 0.9)
ggsave("./noDD4case.pdf", width = 8, height = 5, scale = 0.9)
Scheme_temp = ReCAP::analysisScheme(Chicago_RES$mcmc.objs,
Assumptions,c(8,3),
16,Harvest_matrix_at_this_level, skip = c(0,0,0,0,0,0,1,0,0,1, 0,0,1, 0,0,1,0),quota = F)
for(i in 1:length(Female_adult_weight)){
weight = Female_adult_weight[i]
Harvest_weight_vector = c(others,others,rep(weight,6),rep(others,3))
Harvest_matrix_at_this_level = matrix(Harvest_weight_vector,nrow = 11,ncol = 17)
Scheme_temp = ReCAP::analysisScheme(Chicago_RES$mcmc.objs,
Assumptions,c(8,3),
16,Harvest_matrix_at_this_level, skip = c(0,0,0,0,0,0,1,0,0,1, 0,0,1, 0,0,1,0),quota = F)
sum_temp = sapply(Scheme_temp,function(w){
colSums( w,na.rm = T)
})
sum_temp <- t(sum_temp)
mean_dynamic_temp = Reduce("+",Scheme_temp)/length(Scheme_temp)
mean_dynamic_temp_sum = colSums(mean_dynamic_temp)
mean_dynamic[i,] = mean_dynamic_temp_sum
plot_temp <- data.frame(year = 1992:2008,
population = mean_dynamic_temp_sum,
lw = apply(sum_temp,2,quantile, 0.05),
hi = apply(sum_temp,2,quantile, 0.95))
pp[[i]] <- ggplot(data = plot_temp,aes(x = year,y=population))+
geom_line() +
geom_point() +
geom_errorbar(aes(ymin=lw, ymax=hi), width=.1) +
ylab("Reconstructed Population") +
#theme(text = element_text(size=18), axis.text.x = element_text(size = 16))+
geom_hline(yintercept=500, linetype="dashed")
}
ggarrange(plotlist = pp, labels = c("weight 0.5","weight 1","weight 1.5","weight 2"), label.x = 0.2)
ggsave("./noDD4case_skip.pdf", width = 8, height = 5, scale = 0.9)
Scheme_temp = ReCAP::analysisScheme_SimpleDD(Chicago_RES$mcmc.objs,
Assumptions,c(8,3),
16,Harvest_matrix_at_this_level, skip = c(0,0,0,0,0,0,1,0,0,1, 0,0,1, 0,0,1,0),
quota = F, K=2000)
View(ReCAP::analysisScheme_SimpleDD())
View(ReCAP::analysisScheme_SimpleDD)
for(i in 1:length(Female_adult_weight)){
weight = Female_adult_weight[i]
Harvest_weight_vector = c(others,others,rep(weight,6),rep(others,3))
Harvest_matrix_at_this_level = matrix(Harvest_weight_vector,nrow = 11,ncol = 17)
#Scheme_temp = ReCAP::analysisScheme(Chicago_RES$mcmc.objs,
#                                    Assumptions,c(8,3),
#                                    16,Harvest_matrix_at_this_level, skip = c(0,0,0,0,0,0,1,0,0,1, 0,0,1, 0,0,1,0),quota = F)
Scheme_temp = ReCAP::analysisScheme_SimpleDD(Chicago_RES$mcmc.objs,
Assumptions,c(8,3),
16,Harvest_matrix_at_this_level, skip = c(0,0,0,0,0,0,1,0,0,1, 0,0,1, 0,0,1,0),
quota = F, K=2000)
sum_temp = sapply(Scheme_temp,function(w){
colSums( w,na.rm = T)
})
sum_temp <- t(sum_temp)
mean_dynamic_temp = Reduce("+",Scheme_temp)/length(Scheme_temp)
mean_dynamic_temp_sum = colSums(mean_dynamic_temp)
mean_dynamic[i,] = mean_dynamic_temp_sum
plot_temp <- data.frame(year = 1992:2008,
population = mean_dynamic_temp_sum,
lw = apply(sum_temp,2,quantile, 0.05),
hi = apply(sum_temp,2,quantile, 0.95))
pp[[i]] <- ggplot(data = plot_temp,aes(x = year,y=population))+
geom_line() +
geom_point() +
geom_errorbar(aes(ymin=lw, ymax=hi), width=.1) +
ylab("Reconstructed Population") +
#theme(text = element_text(size=18), axis.text.x = element_text(size = 16))+
geom_hline(yintercept=500, linetype="dashed")
}
ggarrange(plotlist = pp, labels = c("weight 0.5","weight 1","weight 1.5","weight 2"), label.x = 0.2)
ggsave("./DD2k_4case_skip.pdf", width = 8, height = 5, scale = 0.9)
for(i in 1:length(Female_adult_weight)){
weight = Female_adult_weight[i]
Harvest_weight_vector = c(others,others,rep(weight,6),rep(others,3))
Harvest_matrix_at_this_level = matrix(Harvest_weight_vector,nrow = 11,ncol = 17)
#Scheme_temp = ReCAP::analysisScheme(Chicago_RES$mcmc.objs,
#                                    Assumptions,c(8,3),
#                                    16,Harvest_matrix_at_this_level, skip = c(0,0,0,0,0,0,1,0,0,1, 0,0,1, 0,0,1,0),quota = F)
Scheme_temp = ReCAP::analysisScheme_SimpleDD(Chicago_RES$mcmc.objs,
Assumptions,c(8,3),
16,Harvest_matrix_at_this_level, skip = c(0,0,0,0,0,0,0,0,0,0, 0,0,0, 0,0,0,0),
quota = F, K=2000)
sum_temp = sapply(Scheme_temp,function(w){
colSums( w,na.rm = T)
})
sum_temp <- t(sum_temp)
mean_dynamic_temp = Reduce("+",Scheme_temp)/length(Scheme_temp)
mean_dynamic_temp_sum = colSums(mean_dynamic_temp)
mean_dynamic[i,] = mean_dynamic_temp_sum
plot_temp <- data.frame(year = 1992:2008,
population = mean_dynamic_temp_sum,
lw = apply(sum_temp,2,quantile, 0.05),
hi = apply(sum_temp,2,quantile, 0.95))
pp[[i]] <- ggplot(data = plot_temp,aes(x = year,y=population))+
geom_line() +
geom_point() +
geom_errorbar(aes(ymin=lw, ymax=hi), width=.1) +
ylab("Reconstructed Population") +
#theme(text = element_text(size=18), axis.text.x = element_text(size = 16))+
geom_hline(yintercept=500, linetype="dashed")
}
ggarrange(plotlist = pp, labels = c("weight 0.5","weight 1","weight 1.5","weight 2"), label.x = 0.2)
ggsave("./DD2k_4case.pdf", width = 8, height = 5, scale = 0.9)
for(i in 1:length(Female_adult_weight)){
weight = Female_adult_weight[i]
Harvest_weight_vector = c(others,others,rep(weight,6),rep(others,3))
Harvest_matrix_at_this_level = matrix(Harvest_weight_vector,nrow = 11,ncol = 17)
#Scheme_temp = ReCAP::analysisScheme(Chicago_RES$mcmc.objs,
#                                    Assumptions,c(8,3),
#                                    16,Harvest_matrix_at_this_level, skip = c(0,0,0,0,0,0,1,0,0,1, 0,0,1, 0,0,1,0),quota = F)
Scheme_temp = ReCAP::analysisScheme_SimpleDD(Chicago_RES$mcmc.objs,
Assumptions,c(8,3),
16,Harvest_matrix_at_this_level, skip = c(0,0,0,0,0,0,0,0,0,0, 0,0,0, 0,0,0,0),
quota = F, K=2000)
sum_temp = sapply(Scheme_temp,function(w){
colSums( w,na.rm = T)
})
sum_temp <- t(sum_temp)
mean_dynamic_temp = Reduce("+",Scheme_temp)/length(Scheme_temp)
mean_dynamic_temp_sum = colSums(mean_dynamic_temp)
mean_dynamic[i,] = mean_dynamic_temp_sum
plot_temp <- data.frame(year = 1992:2008,
population = mean_dynamic_temp_sum,
lw = apply(sum_temp,2,quantile, 0.05),
hi = apply(sum_temp,2,quantile, 0.95))
pp[[i]] <- ggplot(data = plot_temp,aes(x = year,y=population))+
geom_line() +
geom_point() +
geom_errorbar(aes(ymin=lw, ymax=hi), width=.1) +
ylab("Reconstructed Population") +
#theme(text = element_text(size=18), axis.text.x = element_text(size = 16))+
geom_hline(yintercept=500, linetype="dashed")+
geom_hline(yintercept=250, linetype="dashed")
}
ggarrange(plotlist = pp, labels = c("weight 0.5","weight 1","weight 1.5","weight 2"), label.x = 0.2)
ggsave("./DD2k_4case.pdf", width = 8, height = 5, scale = 0.9)
for(i in 1:length(Female_adult_weight)){
weight = Female_adult_weight[i]
Harvest_weight_vector = c(others,others,rep(weight,6),rep(others,3))
Harvest_matrix_at_this_level = matrix(Harvest_weight_vector,nrow = 11,ncol = 17)
#Scheme_temp = ReCAP::analysisScheme(Chicago_RES$mcmc.objs,
#                                    Assumptions,c(8,3),
#                                    16,Harvest_matrix_at_this_level, skip = c(0,0,0,0,0,0,1,0,0,1, 0,0,1, 0,0,1,0),quota = F)
Scheme_temp = ReCAP::analysisScheme_SimpleDD(Chicago_RES$mcmc.objs,
Assumptions,c(8,3),
16,Harvest_matrix_at_this_level, skip = c(0,0,0,0,0,0,1,0,0,1, 0,0,1, 0,0,1,0),
quota = F, K=2000)
sum_temp = sapply(Scheme_temp,function(w){
colSums( w,na.rm = T)
})
sum_temp <- t(sum_temp)
mean_dynamic_temp = Reduce("+",Scheme_temp)/length(Scheme_temp)
mean_dynamic_temp_sum = colSums(mean_dynamic_temp)
mean_dynamic[i,] = mean_dynamic_temp_sum
plot_temp <- data.frame(year = 1992:2008,
population = mean_dynamic_temp_sum,
lw = apply(sum_temp,2,quantile, 0.05),
hi = apply(sum_temp,2,quantile, 0.95))
pp[[i]] <- ggplot(data = plot_temp,aes(x = year,y=population))+
geom_line() +
geom_point() +
geom_errorbar(aes(ymin=lw, ymax=hi), width=.1) +
ylab("Reconstructed Population") +
#theme(text = element_text(size=18), axis.text.x = element_text(size = 16))+
geom_hline(yintercept=500, linetype="dashed")+
geom_hline(yintercept=250, linetype="dashed")
}
ggarrange(plotlist = pp, labels = c("weight 0.5","weight 1","weight 1.5","weight 2"), label.x = 0.2)
ggsave("./DD2k_4case_skip.pdf", width = 8, height = 5, scale = 0.9)
for(i in 1:length(Female_adult_weight)){
weight = Female_adult_weight[i]
Harvest_weight_vector = c(others,others,rep(weight,6),rep(others,3))
Harvest_matrix_at_this_level = matrix(Harvest_weight_vector,nrow = 11,ncol = 17)
Scheme_temp = ReCAP::analysisScheme(Chicago_RES$mcmc.objs,
Assumptions,c(8,3),
16,Harvest_matrix_at_this_level, skip = c(0,0,0,0,0,0,1,0,0,1, 0,0,1, 0,0,1,0),quota = F)
#Scheme_temp = ReCAP::analysisScheme_SimpleDD(Chicago_RES$mcmc.objs,
#                                    Assumptions,c(8,3),
#                                    16,Harvest_matrix_at_this_level, skip = c(0,0,0,0,0,0,1,0,0,1, 0,0,1, 0,0,1,0),
#                                    quota = F, K=2000)
sum_temp = sapply(Scheme_temp,function(w){
colSums( w,na.rm = T)
})
sum_temp <- t(sum_temp)
mean_dynamic_temp = Reduce("+",Scheme_temp)/length(Scheme_temp)
mean_dynamic_temp_sum = colSums(mean_dynamic_temp)
mean_dynamic[i,] = mean_dynamic_temp_sum
plot_temp <- data.frame(year = 1992:2008,
population = mean_dynamic_temp_sum,
lw = apply(sum_temp,2,quantile, 0.05),
hi = apply(sum_temp,2,quantile, 0.95))
pp[[i]] <- ggplot(data = plot_temp,aes(x = year,y=population))+
geom_line() +
geom_point() +
geom_errorbar(aes(ymin=lw, ymax=hi), width=.1) +
ylab("Reconstructed Population") +
#theme(text = element_text(size=18), axis.text.x = element_text(size = 16))+
geom_hline(yintercept=500, linetype="dashed")+
geom_hline(yintercept=250, linetype="dashed")
}
ggarrange(plotlist = pp, labels = c("weight 0.5","weight 1","weight 1.5","weight 2"), label.x = 0.2)
ggsave("./noDD_4case_skip.pdf", width = 8, height = 5, scale = 0.9)
for(i in 1:length(Female_adult_weight)){
weight = Female_adult_weight[i]
Harvest_weight_vector = c(others,others,rep(weight,6),rep(others,3))
Harvest_matrix_at_this_level = matrix(Harvest_weight_vector,nrow = 11,ncol = 17)
Scheme_temp = ReCAP::analysisScheme(Chicago_RES$mcmc.objs,
Assumptions,c(8,3),
16,Harvest_matrix_at_this_level, skip = c(0,0,0,0,0,0,0,0,0,0, 0,0,0, 0,0,0,0),quota = F)
#Scheme_temp = ReCAP::analysisScheme_SimpleDD(Chicago_RES$mcmc.objs,
#                                    Assumptions,c(8,3),
#                                    16,Harvest_matrix_at_this_level, skip = c(0,0,0,0,0,0,1,0,0,1, 0,0,1, 0,0,1,0),
#                                    quota = F, K=2000)
sum_temp = sapply(Scheme_temp,function(w){
colSums( w,na.rm = T)
})
sum_temp <- t(sum_temp)
mean_dynamic_temp = Reduce("+",Scheme_temp)/length(Scheme_temp)
mean_dynamic_temp_sum = colSums(mean_dynamic_temp)
mean_dynamic[i,] = mean_dynamic_temp_sum
plot_temp <- data.frame(year = 1992:2008,
population = mean_dynamic_temp_sum,
lw = apply(sum_temp,2,quantile, 0.05),
hi = apply(sum_temp,2,quantile, 0.95))
pp[[i]] <- ggplot(data = plot_temp,aes(x = year,y=population))+
geom_line() +
geom_point() +
geom_errorbar(aes(ymin=lw, ymax=hi), width=.1) +
ylab("Reconstructed Population") +
#theme(text = element_text(size=18), axis.text.x = element_text(size = 16))+
geom_hline(yintercept=500, linetype="dashed")+
geom_hline(yintercept=250, linetype="dashed")
}
ggarrange(plotlist = pp, labels = c("weight 0.5","weight 1","weight 1.5","weight 2"), label.x = 0.2)
ggsave("./noDD_4case.pdf", width = 8, height = 5, scale = 0.9)
