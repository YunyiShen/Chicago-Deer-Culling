lambda <- 1
theta <- rgamma(1000,1000,1000)
ws <- rgamma(1000,1,1)
ws <- ws/sum(ws)
mu <- 0
fs <- 0 * ys
for(i in 1:length(theta)){
fs <- fs + ws[i] * eqn4(ys, mu, theta[i],lambda)
}
plot(ys,fs, type = "l")
lambda <- 0
theta <- rgamma(1000,1000,1000)
ws <- rgamma(1000,1,1)
ws <- ws/sum(ws)
mu <- 0
fs <- 0 * ys
for(i in 1:length(theta)){
fs <- fs + ws[i] * eqn4(ys, mu, theta[i],lambda)
}
plot(ys,fs, type = "l")
ys <- seq(-10,10,0.001)
lambda <- 0
theta <- rgamma(100,1000,1000)
ws <- rgamma(100,1,1)
ws <- ws/sum(ws)
mu <- 0
fs <- 0 * ys
for(i in 1:length(theta)){
fs <- fs + ws[i] * eqn4(ys, mu, theta[i],lambda)
}
plot(ys,fs, type = "l")
lambda <- 0
theta <- rgamma(100,10,10)
ws <- rgamma(100,1,1)
ws <- ws/sum(ws)
mu <- 0
fs <- 0 * ys
for(i in 1:length(theta)){
fs <- fs + ws[i] * eqn4(ys, mu, theta[i],lambda)
}
plot(ys,fs, type = "l")
lambda <- 0
theta <- exp(rnorm(100,0,1))
ws <- rgamma(100,1,1)
ws <- ws/sum(ws)
mu <- 0
fs <- 0 * ys
for(i in 1:length(theta)){
fs <- fs + ws[i] * eqn4(ys, mu, theta[i],lambda)
}
plot(ys,fs, type = "l")
lambda <- 0
theta <- exp(rnorm(100,0,100))
ws <- rgamma(100,1,1)
ws <- ws/sum(ws)
mu <- 0
fs <- 0 * ys
for(i in 1:length(theta)){
fs <- fs + ws[i] * eqn4(ys, mu, theta[i],lambda)
}
plot(ys,fs, type = "l")
lambda <- 0
theta <- exp(rnorm(100,0,0.1))
ws <- rgamma(100,1,1)
ws <- ws/sum(ws)
mu <- 0
fs <- 0 * ys
for(i in 1:length(theta)){
fs <- fs + ws[i] * eqn4(ys, mu, theta[i],lambda)
}
plot(ys,fs, type = "l")
lambda <- 0
theta <- exp(rnorm(100,0,0.1))
ws <- rgamma(100,100,100)
ws <- ws/sum(ws)
mu <- 0
fs <- 0 * ys
for(i in 1:length(theta)){
fs <- fs + ws[i] * eqn4(ys, mu, theta[i],lambda)
}
plot(ys,fs, type = "l")
lambda <- 0
theta <- exp(rnorm(100,0,0.1))
ws <- rgamma(100,.1,.1)
ws <- ws/sum(ws)
mu <- 0
fs <- 0 * ys
for(i in 1:length(theta)){
fs <- fs + ws[i] * eqn4(ys, mu, theta[i],lambda)
}
plot(ys,fs, type = "l")
lambda <- 0
theta <- exp(rnorm(100,0,0.001))
ws <- rgamma(100,.1,.1)
lambda <- 0
theta <- exp(rnorm(100,0,5))
ws <- rgamma(100,.1,.1)
ws <- ws/sum(ws)
mu <- 0
fs <- 0 * ys
for(i in 1:length(theta)){
fs <- fs + ws[i] * eqn4(ys, mu, theta[i],lambda)
}
plot(ys,fs, type = "l")
lambda <- 0
theta <- exp(rnorm(100,0,2))
ws <- rgamma(100,.1,.1)
ws <- ws/sum(ws)
mu <- 0
fs <- 0 * ys
for(i in 1:length(theta)){
fs <- fs + ws[i] * eqn4(ys, mu, theta[i],lambda)
}
plot(ys,fs, type = "l")
lambda <- 0
theta <- exp(rnorm(1000,0,2))
ws <- rgamma(1000,.1,.1)
ws <- ws/sum(ws)
mu <- 0
fs <- 0 * ys
for(i in 1:length(theta)){
fs <- fs + ws[i] * eqn4(ys, mu, theta[i],lambda)
}
plot(ys,fs, type = "l")
theta <- exp(rnorm(1000,0,2))
ws <- rgamma(1000,.1,.1)
ws <- ws/sum(ws)
mu <- 0
fs <- 0 * ys
for(i in 1:length(theta)){
fs <- fs + ws[i] * eqn4(ys, mu, theta[i],lambda)
}
plot(ys,fs, type = "l")
lambda <- 0
theta <- exp(rnorm(1000,0,1))
ws <- rgamma(1000,.1,.1)
ws <- ws/sum(ws)
mu <- 0
fs <- 0 * ys
for(i in 1:length(theta)){
fs <- fs + ws[i] * eqn4(ys, mu, theta[i],lambda)
}
plot(ys,fs, type = "l")
1/1292
(1-1/1292)^4000
(1-1/1896)^4000
(1-1/17)^4000
356+12
40000-8579
(40000-8579)/12
8200/171
47.17 * 1.04
46.17 * 1.04
48*200
46.7*1.04
library(CARlasso)
gut_res <- CARlasso(Alistipes+Bacteroides+
Eubacterium+Parabacteroides+all_others~
BMI+Age+Gender+Stratum,
data = mgp154,link = "logit",
adaptive = TRUE, n_iter = 5000,
n_burn_in = 1000, thin_by = 10)
plot(gut_res)
install.packages("pkgdown")
install.packages("pkgdown")
usethis::use_pkgdown()
library(CARlasso)
example(CARlasso)
example(BGlasso)
example(bGlasso)
license()
install.packages("rhub")
??QUIC
ww <- rnorm(10000)
plot(exp(ww),type = "l")
plot((ww),type = "l")
?svd
x <- matrix(rnorm(100*2),ncol = 2)
beta <- c(1,-1)
xb <- x%*% beta
p
p <- 1/(1+exp(-xb))
y <- runif(100)<=p
library(glmnet)
?glmnet
glmnet(x,y,family = "binomial", offset = rep(0,100))
library(glmnet)
View(glmnet)
x <- matrix(rnorm(2*50),50)
beta <- c(1,-1)
xb <- x %*% beta
mu <- 0
y <- runif(50) <= 1/(1+exp(-xb))
ww1 <- glmnet(x,y, family = binomial())
ww2 <- glmnet(x,y, family = "binomial")
ww1
coef(ww1)
coef(ww2)
y <- runif(50) <= 1/(1+exp(-xb-1))
ww2 <- glmnet(x,y, family = "binomial", offset = rep(1,50))
ww1 <- glmnet(x,y, family = binomial(), offset = rep(1,50))
coef(ww1)
coef(ww2)
?binomial
y <- runif(50) <= 1/(1+exp(-xb-10))
hist(y)
mean(y)
x <- matrix(rnorm(2*5000),5000)
xb <- x %*% beta
y <- runif(50) <= 1/(1+exp(-xb-6))
mean(y)
ww1 <- glmnet(x,y, family = binomial(), offset = rep(6,5000))
y <- runif(5000) <= 1/(1+exp(-xb-6))
ww1 <- glmnet(x,y, family = binomial(), offset = rep(6,5000))
coef(ww1)
ww <- glmnet(x,y, family = "binomial", offset = rep(6,5000))
coef(ww)
coef(ww)[,1]
coef(ww1)[,1]
ww <- glmnet(x,y, family = "binomial", offset = rep(6,5000), intercept = F)
ww1 <- glmnet(x,y, family = binomial(), offset = rep(6,5000), intercept = F)
coef(ww1)[,1]
coef(ww)[,1]
coef(ww)[,1:5]
coef(ww1)[,1:5]
coef(ww)[,1:10]
coef(ww1)[,1:10]
234/146
1.6*12
log10(2)
468/50*12
setwd("/media/yunyi/Academia/UW Lab jobs/3. Lislie Reconstruction/DDLeslie_package/Chicago_scheme/Reconstruction/Main_analysis_Chicago/_fig_code_")
load("/media/yunyi/Academia/UW Lab jobs/3. Lislie Reconstruction/DDLeslie_package/Chicago_scheme/Population_simulation_scheme/4harv_8fec_6surv_equal.RData")
require(ggplot2)
# Just for plotting things
period = 17
## Harvest prediction
mean.harv = apply(Chicago_RES$mcmc.objs$H.mcmc,2,mean)
mean.harv.matrix = matrix(mean.harv,ncol = period, byrow=T)
mean.harv.mean = data.frame(age = c(paste0("F",1:2),paste0("M",1:2)), mean.harv.matrix)
BI.low.harv = apply(Chicago_RES$mcmc.objs$H.mcmc,2,quantile,probs = .025)
BI.low.harv.matrix = matrix(BI.low.harv,ncol = period, byrow = T)
BI_harv_low = data.frame(age = c(paste0("F",1:2),paste0("M",1:2)),BI.low.harv.matrix)
BI.high.harv = apply(Chicago_RES$mcmc.objs$H.mcmc,2,quantile,probs = .975)
BI.high.harv.matrix = matrix(BI.high.harv,ncol = period, byrow = T)
BI_harv_high = data.frame(age = c(paste0("F",1:2),paste0("M",1:2)),BI.high.harv.matrix)
har_data = data.frame(matrix(nrow = 1,ncol = 5))
colnames(har_data) = c("age","mean","low","high","time")
har_data = har_data[-1,]
age_code <- c("Female.Fawn","Female.Adult","Male.Fawn","Male.Adult")
require(ggplot2)
all_summary = data.frame(harvest.rate = mean.harv.matrix[1,],low = BI.low.harv.matrix[1,],high = BI.high.harv.matrix[1,],time = 1992:2008, group = age_code[1])
for(i in 2:4){
temp1 = data.frame(harvest.rate  = mean.harv.matrix[i,],low = BI.low.harv.matrix[i,],high = BI.high.harv.matrix[i,],time = 1992:2008, group = age_code[i])
all_summary <- rbind(temp1,all_summary)
}
all_summary[,1:3] <- 1/(1+exp(-all_summary[,1:3]))
ggplot(data = all_summary, aes(x=time,y=harvest.rate,col = group))+
geom_line()+
geom_errorbar(aes(ymin = low, ymax = high),size = .2)
pp <- list()
for(i in 1:4){
temp <- all_summary[all_summary$group==age_code[i],]
temp <- temp[temp$time!=1992,]
temp <- cbind(temp,lambda_val)
pp_temp <- ggplot(data = temp, aes(x=harvest.rate,y=lambda))+
geom_point()+
geom_errorbar(aes(xmin=low,xmax = high, ymin = lambda.low,ymax = lambda.high),size = 0.2)+
geom_errorbarh(aes(xmin=low,xmax = high),size = 0.2)+
xlim(0,1)+
ylim(0.5,1.5)+
#geom_smooth(method=lm) +
geom_hline(yintercept = 1,col = "red", linetype = 2)#+
#xlab(age_code[i])
pp[[i]] <- pp_temp
}
mean.lambda = apply(lambda_MCMC,2,mean)
BI.low.lambda = apply(lambda_MCMC,2,quantile,probs = .025)
BI.high.lambda = apply(lambda_MCMC,2,quantile,probs = .975)
lambda_MCMC <- matrix(NA, nrow = 2000, ncol = period-1)
for(i in 1:2000){
temp <- matrix(Chicago_RES$mcmc.objs$living.mcmc[i,], ncol = period, byrow = F)
temp <- colSums(temp)
lambda_MCMC[i,] <- temp[-1]/temp[-period]
}
mean.lambda = apply(lambda_MCMC,2,mean)
BI.low.lambda = apply(lambda_MCMC,2,quantile,probs = .025)
BI.high.lambda = apply(lambda_MCMC,2,quantile,probs = .975)
lambda_val <- data.frame(year = 1993:2008, lambda = mean.lambda, lambda.low = BI.low.lambda, lambda.high = BI.high.lambda)
write.csv(lambda_val, "lambda_summary.csv",row.names = F)
pp <- list()
for(i in 1:4){
temp <- all_summary[all_summary$group==age_code[i],]
temp <- temp[temp$time!=1992,]
temp <- cbind(temp,lambda_val)
pp_temp <- ggplot(data = temp, aes(x=harvest.rate,y=lambda))+
geom_point()+
geom_errorbar(aes(xmin=low,xmax = high, ymin = lambda.low,ymax = lambda.high),size = 0.2)+
geom_errorbarh(aes(xmin=low,xmax = high),size = 0.2)+
xlim(0,1)+
ylim(0.5,1.5)+
#geom_smooth(method=lm) +
geom_hline(yintercept = 1,col = "red", linetype = 2)#+
#xlab(age_code[i])
pp[[i]] <- pp_temp
}
ggarrange(plotlist = pp, labels =age_code, label.x = 0.1,align = "hv")
ggpubr::ggarrange(plotlist = pp, labels =age_code, label.x = 0.1,align = "hv")
for(i in 1:4){
temp <- all_summary[all_summary$group==age_code[i],]
temp <- temp[temp$time!=1992,]
temp <- cbind(temp,lambda_val)
pp_temp <- ggplot(data = temp, aes(x=harvest.rate,y=lambda))+
geom_point()+
geom_errorbar(aes(xmin=low,xmax = high, ymin = lambda.low,ymax = lambda.high),size = 0.2)+
geom_errorbarh(aes(xmin=low,xmax = high),size = 0.2)+
xlim(0,.9)+
ylim(0.3,1.5)+
#geom_smooth(method=lm) +
geom_hline(yintercept = 1,col = "red", linetype = 2)#+
#xlab(age_code[i])
pp[[i]] <- pp_temp
}
ggpubr::ggarrange(plotlist = pp, labels =age_code, label.x = 0.1,align = "hv")
ggsave("./rate_vs_lambda.pdf",width = 12, height = 8, scale = .8)
H_all_MCMC <- matrix(NA, nrow = 2000, ncol = period)
for(i in 1:2000){
temp_living <- matrix(Chicago_RES$mcmc.objs$living.mcmc[i,], ncol = period, byrow = F)
temp_harving <- matrix(Chicago_RES$mcmc.objs$harvest.mcmc[i,], ncol = period, byrow = F)
temp_living <- colSums(temp_living)
temp_harving <- colSums(temp_harving)
H_all_MCMC[i,] <- temp_harving/(temp_living+temp_harving)
}
mean.Hall = apply(H_all_MCMC ,2,mean)
BI.low.Hall = apply(H_all_MCMC ,2,quantile,probs = .025)
BI.high.Hall = apply(H_all_MCMC ,2,quantile,probs = .975)
Hall_val <- data.frame(year = 1992:2008, lambda = mean.Hall, Hall.low = BI.low.Hall, lambda.high = BI.high.Hall)
plot(mean.Hall)
write.csv(Hall_val,"harvest_rate_overall.csv",row.names = F)
hallvslambda <- cbind(Hall_val[Hall_val$year!=1992,], lambda_val)
Hall_val <- data.frame(year = 1992:2008, harvest.rate = mean.Hall, Hall.low = BI.low.Hall, lambda.high = BI.high.Hall)
write.csv(Hall_val,"harvest_rate_overall.csv",row.names = F)
hallvslambda <- cbind(Hall_val[Hall_val$year!=1992,], lambda_val)
ggplot(data = hallvslambda, aes(x=harvest.rate,y=lambda))+
geom_point()+
geom_errorbar(aes(xmin=low,xmax = high, ymin = lambda.low,ymax = lambda.high),size = 0.2)+
geom_errorbarh(aes(xmin=low,xmax = high),size = 0.2)+
xlim(0,.9)+
ylim(0.3,1.5)+
#geom_smooth(method=lm) +
geom_hline(yintercept = 1,col = "red", linetype = 2)
View(hallvslambda)
hallvslambda <- merge(Hall_val[Hall_val$year!=1992,], lambda_val)
View(Hall_val)
hallvslambda <- cbind(Hall_val[Hall_val$year!=1992,-1], lambda_val)
View(Hall_val)
hallvslambda <- cbind(Hall_val[Hall_val$year!=1992,-1], lambda_val)
View(hallvslambda)
ggplot(data = hallvslambda, aes(x=harvest.rate,y=lambda))+
geom_point()+
geom_errorbar(aes(xmin=low,xmax = high, ymin = lambda.low,ymax = lambda.high),size = 0.2)+
geom_errorbarh(aes(xmin=low,xmax = high),size = 0.2)+
xlim(0,.9)+
ylim(0.3,1.5)+
#geom_smooth(method=lm) +
geom_hline(yintercept = 1,col = "red", linetype = 2)
View(hallvslambda)
Hall_val <- data.frame(year = 1992:2008, harvest.rate = mean.Hall, Hall.low = BI.low.Hall, Hall.high = BI.high.Hall)
write.csv(Hall_val,"harvest_rate_overall.csv",row.names = F)
hallvslambda <- cbind(Hall_val[Hall_val$year!=1992,-1], lambda_val)
ggplot(data = hallvslambda, aes(x=harvest.rate,y=lambda))+
geom_point()+
geom_errorbar(aes(xmin=low,xmax = high, ymin = lambda.low,ymax = lambda.high),size = 0.2)+
geom_errorbarh(aes(xmin=low,xmax = high),size = 0.2)+
xlim(0,.9)+
ylim(0.3,1.5)+
#geom_smooth(method=lm) +
geom_hline(yintercept = 1,col = "red", linetype = 2)
ggplot(data = hallvslambda, aes(x=harvest.rate,y=lambda))+
geom_point()+
geom_errorbar(aes(xmin=Hall.low,xmax = Hall.high, ymin = lambda.low,ymax = lambda.high),size = 0.2)+
geom_errorbarh(aes(xmin=Hall.low,xmax = Hall.high),size = 0.2)+
xlim(0,.9)+
ylim(0.3,1.5)+
#geom_smooth(method=lm) +
geom_hline(yintercept = 1,col = "red", linetype = 2)
ggplot(data = hallvslambda, aes(x=harvest.rate,y=lambda))+
geom_point()+
geom_errorbar(aes(xmin=Hall.low,xmax = Hall.high, ymin = lambda.low,ymax = lambda.high),size = 0.2)+
geom_errorbarh(aes(xmin=Hall.low,xmax = Hall.high),size = 0.2)+
xlim(0.1,.8)+
ylim(0.3,1.5)+
#geom_smooth(method=lm) +
geom_hline(yintercept = 1,col = "red", linetype = 2)
ggplot(data = hallvslambda, aes(x=harvest.rate,y=lambda))+
geom_point()+
geom_errorbar(aes(xmin=Hall.low,xmax = Hall.high, ymin = lambda.low,ymax = lambda.high),size = 0.2)+
geom_errorbarh(aes(xmin=Hall.low,xmax = Hall.high),size = 0.2)+
xlim(0.1,.8)+
ylim(0.3,1.5)+
geom_smooth(method=lm) +
geom_hline(yintercept = 1,col = "red", linetype = 2)
ggplot(data = hallvslambda, aes(x=harvest.rate,y=lambda))+
geom_point(aes(col = year))+
geom_errorbar(aes(xmin=Hall.low,xmax = Hall.high, ymin = lambda.low,ymax = lambda.high),size = 0.2)+
geom_errorbarh(aes(xmin=Hall.low,xmax = Hall.high),size = 0.2)+
xlim(0.1,.8)+
ylim(0.3,1.5)+
geom_smooth(method=lm) +
geom_hline(yintercept = 1,col = "red", linetype = 2)
ggplot(data = hallvslambda, aes(x=harvest.rate,y=lambda))+
geom_point(aes(col = factor(year)))+
geom_errorbar(aes(xmin=Hall.low,xmax = Hall.high, ymin = lambda.low,ymax = lambda.high),size = 0.2)+
geom_errorbarh(aes(xmin=Hall.low,xmax = Hall.high),size = 0.2)+
xlim(0.1,.8)+
ylim(0.3,1.5)+
geom_smooth(method=lm) +
geom_hline(yintercept = 1,col = "red", linetype = 2)
ggplot(data = hallvslambda, aes(x=harvest.rate,y=lambda))+
geom_smooth(method=lm) +
geom_point(aes(col = factor(year)))+
geom_errorbar(aes(xmin=Hall.low,xmax = Hall.high, ymin = lambda.low,ymax = lambda.high),size = 0.2)+
geom_errorbarh(aes(xmin=Hall.low,xmax = Hall.high),size = 0.2)+
xlim(0.1,.8)+
ylim(0.3,1.5)+
geom_hline(yintercept = 1,col = "red", linetype = 2)
hallvslambda$year <- as.factor(hallvslambda$year)
ggplot(data = hallvslambda, aes(x=harvest.rate,y=lambda))+
geom_smooth(method=lm) +
geom_point(aes(col = (year)))+
geom_errorbar(aes(xmin=Hall.low,xmax = Hall.high, ymin = lambda.low,ymax = lambda.high),size = 0.2)+
geom_errorbarh(aes(xmin=Hall.low,xmax = Hall.high),size = 0.2)+
xlim(0.1,.8)+
ylim(0.3,1.5)+
geom_hline(yintercept = 1,col = "red", linetype = 2)
ggplot(data = hallvslambda, aes(x=harvest.rate,y=lambda))+
geom_smooth(method=lm) +
geom_point(aes(col = (year)))+
geom_errorbar(aes(xmin=Hall.low,xmax = Hall.high, ymin = lambda.low,ymax = lambda.high),size = 0.2)+
geom_errorbarh(aes(xmin=Hall.low,xmax = Hall.high),size = 0.2)+
xlim(0.1,.75)+
ylim(0.3,1.5)+
geom_hline(yintercept = 1,col = "red", linetype = 2)
ggplot(data = hallvslambda, aes(x=harvest.rate,y=lambda))+
geom_smooth(method=lm) +
geom_point(aes(shape = year))+
geom_errorbar(aes(xmin=Hall.low,xmax = Hall.high, ymin = lambda.low,ymax = lambda.high),size = 0.2)+
geom_errorbarh(aes(xmin=Hall.low,xmax = Hall.high),size = 0.2)+
xlim(0.1,.75)+
ylim(0.3,1.5)+
geom_hline(yintercept = 1,col = "red", linetype = 2)
ggplot(data = hallvslambda, aes(x=harvest.rate,y=lambda))+
geom_smooth(method=lm) +
geom_point(aes(col = year))+
geom_errorbar(aes(xmin=Hall.low,xmax = Hall.high, ymin = lambda.low,ymax = lambda.high),size = 0.2)+
geom_errorbarh(aes(xmin=Hall.low,xmax = Hall.high),size = 0.2)+
xlim(0.1,.75)+
ylim(0.3,1.5)+
geom_hline(yintercept = 1,col = "red", linetype = 2)
ggplot(data = hallvslambda, aes(x=harvest.rate,y=lambda))+
geom_smooth(method=lm, size = .2) +
geom_point(aes(col = year))+
geom_errorbar(aes(xmin=Hall.low,xmax = Hall.high, ymin = lambda.low,ymax = lambda.high),size = 0.2)+
geom_errorbarh(aes(xmin=Hall.low,xmax = Hall.high),size = 0.2)+
xlim(0.1,.75)+
ylim(0.3,1.5)+
geom_hline(yintercept = 1,col = "red", linetype = 2)
ggplot(data = hallvslambda, aes(x=harvest.rate,y=lambda))+
geom_smooth(method=lm, size = .5) +
geom_point(aes(col = year))+
geom_errorbar(aes(xmin=Hall.low,xmax = Hall.high, ymin = lambda.low,ymax = lambda.high),size = 0.2)+
geom_errorbarh(aes(xmin=Hall.low,xmax = Hall.high),size = 0.2)+
xlim(0.1,.75)+
ylim(0.3,1.5)+
geom_hline(yintercept = 1,col = "red", linetype = 2)
ggplot(data = hallvslambda, aes(x=harvest.rate,y=lambda))+
geom_smooth(method=lm, size = .5) +
geom_point(aes(col = year))+
geom_errorbar(aes(xmin=Hall.low,xmax = Hall.high, ymin = lambda.low,ymax = lambda.high),size = 0.2)+
geom_errorbarh(aes(xmin=Hall.low,xmax = Hall.high),size = 0.2)+
xlim(0.1,.7)+
ylim(0.3,1.5)+
geom_hline(yintercept = 1,col = "red", linetype = 2)
ggplot(data = hallvslambda, aes(x=harvest.rate,y=lambda))+
geom_smooth(method=lm, size = .5) +
geom_point(aes(col = year))+
geom_errorbar(aes(xmin=Hall.low,xmax = Hall.high, ymin = lambda.low,ymax = lambda.high),size = 0.2)+
geom_errorbarh(aes(xmin=Hall.low,xmax = Hall.high),size = 0.2)+
xlim(0.15,.7)+
ylim(0.3,1.5)+
geom_hline(yintercept = 1,col = "red", linetype = 2)
ggplot(data = hallvslambda, aes(x=harvest.rate,y=lambda))+
geom_smooth(method=lm, size = .5) +
geom_point(aes(col = year))+
geom_errorbar(aes(xmin=Hall.low,xmax = Hall.high, ymin = lambda.low,ymax = lambda.high),size = 0.2)+
geom_errorbarh(aes(xmin=Hall.low,xmax = Hall.high),size = 0.2)+
xlim(0.12,.7)+
ylim(0.3,1.5)+
geom_hline(yintercept = 1,col = "red", linetype = 2)
ggsave("./rate_overall_vs_lambda.pdf", width = 8, height = 6, scale = 0.8)
ggsave("./rate_overall_vs_lambda.pdf", width = 8, height = 5, scale = 0.8)
ggsave("./rate_overall_vs_lambda.pdf", width = 8, height = 5.5, scale = 0.8)
ggplot(data = hallvslambda, aes(x=harvest.rate,y=lambda))+
geom_smooth(method=lm, size = .5) +
#geom_point(aes(col = year))+
geom_point()+
geom_errorbar(aes(xmin=Hall.low,xmax = Hall.high, ymin = lambda.low,ymax = lambda.high),size = 0.2)+
geom_errorbarh(aes(xmin=Hall.low,xmax = Hall.high),size = 0.2)+
xlim(0.12,.7)+
ylim(0.3,1.5)+
geom_hline(yintercept = 1,col = "red", linetype = 2)
ggsave("./rate_overall_vs_lambda1.pdf", width = 8, height = 5.5, scale = 0.8)
